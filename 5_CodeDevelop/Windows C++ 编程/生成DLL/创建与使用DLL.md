与静态链接库一样，DLL 也是按名称导出变量、函数和资源。客户端应用导入名称以使用这些变量、函数和资源。与静态链接库不同的是，Windows 在加载时或在运行时将应用中的导入连接到 DLL 中的导出，而不是在链接时连接它们。 Windows 需要不属于标准 C++ 编译模型的额外信息才能建立这些连接。 MSVC 编译器实现了一些 Microsoft 专用 C++ 扩展，以提供此额外信息。

---

# 创建 DLL 项目


1、在菜单栏上，选择 “文件” > “新建” > “项目”，打开 “创建新项目” 对话框。


![[20240626172350.png]]


2、在对话框顶部，将 “语言” 设置为 “C++”，将 “平台” 设置为 “Windows”，并将 “项目类型” 设置为 “库”。

3、从经过筛选的项目类型列表中，选择 “动态链接库 (DLL)”，然后选择 “下一步”。

4、在 “配置新项目” 页面，在 “项目名称” 框中输入 “MathLibrary”，以指定项目的名称。保留默认 “位置” 和 “解决方案名称” 值。将 “解决方案” 设置为 “创建新解决方案”。如果 “将解决方案和项目放在同一目录中” 已选中，则取消选中。

5、选择“创建”按钮创建项目。

创建解决方案后，就可以在 Visual Studio 中的“解决方案资源管理器”窗口中看到生成的项目和源文件了。

![[20240626172755.png]]

目前，此 DLL 并没有起到很大的作用。接下来，创建一个头文件来声明 DLL 导出的函数，然后将函数定义添加到 DLL，使其具备更强大的功能。

# 将头文件添加到 DLL

1、若要为函数创建头文件，请在菜单栏上选择 “项目” > “添加新项”。

2、在 “添加新项” 对话框的左窗格中，选择 “Visual C++”。在中间窗格中，选择 “头文件 (.h)”。指定 `MathLibrary.h` 作为头文件的名称。

![[20240626173056.png]]

3、选择 “添加” 按钮以生成一个空白头文件，该文件显示在新的编辑器窗口中。