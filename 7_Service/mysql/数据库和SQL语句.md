# 数据库简介

## 数据库概念

在实际的开发过程中，应用程序会有大量的数据需要持久地存储在磁盘之中，目前我们已知的持久化存储的方式就是采用文件，但是在磁盘物理的结构上，文件其实是一种顺序的字符集合。使用文件可以很方便地输入和输出数据，但是这些数据都是简单的字节流，不包含任何复杂数据结构，所以应用开发者需要花费大量的时间去解析文件的内容，并将其映射到内存的数据结构以供应用程序后续使用。

除此之外，由于磁盘的顺序读写的速度要远远快于随机读写，所以为了访问位置靠后的数据，要消耗大量的时间（类似于链表的访问）。另外，文件系统的数据无法保证数据的安全性，应用程序没有办法在存储数
据的时候检查其是否正确，而当部分数据损坏时，文件系统本身无法定位问题和设计修复方案。

数据库即数据仓库，它是一系列结构化的数据的集合，其作用是对结构化的数据进行持久存储。我们把数据库中的数据、数据库管理系统和其他关联应用统称为数据库。数据库在系统的位置介于磁盘文件系统和应用程序之间，一方面，数据库对上层应用程序提供了持久化地读写数据的接口，使应用程序可以尽量高效地将内存数据结构在磁盘中访问、存储和修改。另一方面，数据库采用了高级的数据结构来组织在磁盘的数据，并在内存当中设计了高效的缓存系统，从而可以充分利用磁盘的各种特点（比如读写速度远逊色于内存，顺序读写的速度远高于随机访问的速度等等），从而最大化上层应用程序的性能。

![[20240805214353.png]]


## 数据库的分类

我们无意于过分深入数据库的历史沿革，而是会聚焦于当前的数据库产品的市场——当前的数据库可以分成两大阵营：关系型数据库和非关系型数据库。

关系型数据库使用关系来组织数据库当中的各个数据，所谓的关系可以认为就是有若干行和列构成的表格。由于关系型数据库便于理解易于使用，所以长期以来是市场上的主流数据库模式。关系型数据库通常会一个名为 SQL（Structured Query Language，结构化查询语言）的语言来访问和更新。现在市场占用率比较的关系型数据库有这些：Oracle、MySQL、PostgreSQL、DB2、Informix、Sybase、SQL Server 2000、Access、SQLite。Oracle 是商业数据库，性能优异但是收费昂贵，一般用于传统行业和银行领域；MySQL 和 PostgreSQL 是开源的关系型数据库管理系统，被大多数互联网公司采用。

非关系型数据库现在一般统称为 NoSQL，由于在市场竞争中始终无法取代关系型数据库，现在一般将其解释为"Not only SQL"，从而表示非关系型数据库是关系型数据的补充之义。NoSQL 一般认为不适合作为通用领域的存储部件，但是在一些特定领域，比如高并发领域等等还是有一定的用武之地。常见的NoSQL 产品有：Redis、Memcached、MongoDB、Cassandra 等等。NoSQL 的存储结构各有千秋，不过一般都会支持 key-value 的键值对存储结构。

# 关系型数据库

## 关系

关系型数据库使用**关系**来组织数据库当中的各个数据。所谓的关系可以认为就是有若干**行**和**列**构成的表。表中的一行也叫一个记录，它以**元组**的形式存在，用来描述一个具体对象各个数据。

在这个元组中，会存在多个域，每个域代表了某个对象当中的某一个属性。所有对象的同一属性构成了一列，每一列有着自己独特的名字。对于关系当中的每一个属性，都有一个允许取值的集合，我们也称之为域。

## 主键和外键

如何区分一个关系中两个不同的元组？我们需要挑选元组中某个属性或者多个属性的组合作为标识，不同的元组的在这些属性的取值上一定不同，满足这样需求的属性集合称为**超级键**。而这些集合中元素最少的称为候选键（其真子集必然不是超级键），数据库管理员可以选择一个候选键当作主键。我们尽量不要用描述具体信息的属性充当主键（比如姓名、职位），主键一般的选择是一个无意义的自动自增的整数，这样可以尽量避免修改（比如假设使用公司名作为主键，若发生公司合并的情况）。

## SQL

SQL 即结构化查询语言，其最初的数学来源是关系代数和元组关系演算。在逐渐地演变过程，SQL 既可以用来管理和维护数据库系统，又可以查询、添加、更新和删除数据库当中的数据。

SQL 和之前所学习过的 C 语言不同：C 语言是一种过程式的语言，它被用来描述怎样去完成一个任务各个步骤；而 SQL 是一种声明式的语言，它并不关心如果实际地从数据库中提取的过程，用户也无需了解数据的存储结构，它只是简单地说明了任务的目标，而具体的执行步骤则由数据库系统的语句解析器和优化器生成，并最终被存储引擎执行。

这是某个版本的 mysql 内部结构图示意（仅供参考）：

![[20240805215152.png]]


总的来说，SQL 语言定义了这么几种操作数据库的能力：

- DDL：Data Definition Language，数据定义语言。DDL 允许用户定义数据，也就是创建表、删除表、修改表结构这些操作。通常，DDL 由数据库管理员执行。
- DML：Data Manipulation Language，数据操作语言。DML 为用户提供查询、添加、删除、更新数据的能力，这些是应用程序对数据库的日常操作。其中查询操作是使用得最频繁的操作。
