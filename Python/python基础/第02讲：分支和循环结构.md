# 分支和循环结构

## 分支结构

在 Python 中，要构造分支结构可以使用 `if`、`elif` 和 `else` 关键字。Python 中没有用花括号来构造代码块而是 **使用了缩进的方式来表示代码的层次结构**。

```python
username = input('请输入用户名: ')
password = input('请输入口令: ')

# 用户名是 admin 且密码是 123456 则身份验证成功否则身份验证失败
if username == 'admin' and password == '123456':
    print('身份验证成功!')
else:
    print('身份验证失败!')
```

## 循环结构

所谓循环结构，就是程序中控制某条或某些指令重复执行的结构。在 Python 中构造循环结构有两种做法，一种是 `for-in` 循环，另一种是 `while` 循环。

### for-in 循环

已知循环执行的次数，推荐使用 `for-in` 循环。

被 `for-in` 循环控制的语句块也是通过缩进的方式来构造的，这一点跟分支结构完全相同，示例如下。

```Python
# 用for循环实现1~100求和

total = 0
for x in range(1, 101):
    total += x
print(total)
```

需要说明的是上面代码中的 `range(1, 101)` 可以用来构造一个从 `1` 到 `100` 的范围，当我们把这样一个范围放到 `for-in` 循环中，就可以通过前面的循环变量 `x` 依次取出从 `1` 到 `100` 的整数。当然，`range` 的用法非常灵活，下面给出了一个例子：

- `range(101)`：可以用来产生 0 到 100 范围的整数，需要注意的是取不到 101。
- `range(1, 101)`：可以用来产生 1 到 100 范围的整数，相当于前面是闭区间后面是开区间。
- `range(1, 101, 2)`：可以用来产生 1 到 100 的奇数，其中 2 是步长，即每次递增的值。
- `range(100, 0, -2)`：可以用来产生 100 到 1 的偶数，其中-2 是步长，即每次递减的值。

知道了这一点，我们可以用下面的代码来实现 1~100 之间的偶数求和。

```Python
# 用for循环实现1~100之间的偶数求和

total = 0
for x in range(2, 101, 2):
    total += x
print(total)
```

### while 循环

如果要构造不知道具体循环次数的循环结构，推荐使用 `while` 循环。

`while` 循环通过一个能够产生 `bool` 值的表达式来控制循环，当表达式的值为 `True` 时则继续循环，当表达式的值为 `False` 时则结束循环。

猜数字游戏的规则是：计算机出一个 `1` 到 `100` 之间的随机数，玩家输入要猜的数字，计算机给出对应的提示信息，如果玩家猜中了数字，计算机提示用户一共猜了多少次，游戏结束，否则游戏继续。

```Python
# 猜数字游戏# 产生一个1-100范围的随机数

import random

answer = random.randint(1, 100)
counter = 0
while True:
    counter += 1
    number = int(input('请输入: '))
    if number < answer:
        print('大一点')
    elif number > answer:
        print('小一点')
    else:
        print('恭喜你猜对了!')
        break

# 当退出while循环的时候显示用户一共猜了多少次
print(f'你总共猜了{counter}次')
```

### break 和 continue

上面的代码中使用 `while True` 构造了一个条件恒成立的循环，也就意味着如果不做特殊处理，循环是不会结束的，这也就是常说的“死循环”。

为了在用户猜中数字时能够退出循环结构，我们使用了 `break` 关键字，它的作用是提前结束循环。需要注意的是，`break` 只能终止它所在的那个循环，这一点在使用嵌套循环结构时需要引起注意，下面的例子我们会讲到什么是嵌套的循环结构。除了 `break` 之外，还有另一个关键字是 `continue`，它可以用来放弃本次循环后续的代码直接让循环进入下一轮。

### 嵌套的循环结构

和分支结构一样，循环结构也是可以嵌套的，也就是说在循环中还可以构造循环结构。下面的例子演示了如何通过嵌套的循环来输出一个乘法口诀表（九九表）。

```Python
# 打印乘法口诀表

for i in range(1, 10):
    for j in range(1, i + 1):
        print(f'{i} * {j} = {i * j}', end='\t')
    print()
```

### 练习

例 1：输入一个正整数判断它是不是素数

> **提示**：素数指的是只能被 1 和自身整除的大于 1 的整数。

```Python
# 输入一个正整数判断它是不是素数

num = int(input('请输入一个正整数: '))
end = int(num ** 0.5)
is_prime = True
for x in range(2, end + 1):
    if num % x == 0:
        is_prime = False
        break
if is_prime and num != 1:
    print(f'{num}是素数')
else:
    print(f'{num}不是素数')
```

例 2：输入两个正整数，计算它们的最大公约数和最小公倍数

> **提示**：两个数的最大公约数是两个数的公共因子中最大的那个数；两个数的最小公倍数则是能够同时被两个数整除的最小的那个数。

```Python
# 输入两个正整数计算它们的最大公约数和最小公倍数

x = int(input('x = '))
y = int(input('y = '))
for factor in range(x, 0, -1):
    if x % factor == 0 and y % factor == 0:
        print(f'{x}和{y}的最大公约数是{factor}')
        print(f'{x}和{y}的最小公倍数是{x * y // factor}')
        break
```

**如果知道循环的次数，我们通常使用 `for` 循环；如果循环次数不能确定，可以用 `while` 循环。在循环中还可以使用 `break` 来提前结束循环**。




## 分支与循环的应用练习

### 寻找水仙花数

> **说明**：水仙花数也被称为超完全数字不变数、自恋数、自幂数、阿姆斯特朗数，它是一个 3 位数，该数字每个位上数字的立方之和正好等于它本身，例如：$ 153=1^3+5^3+3^3 $。

这个题目的关键是将一个三位数拆分为个位、十位、百位，这一点利用 Python 中的 `//`（整除）和 `%`（求模）运算符其实很容易做到，代码如下所示。

```Python
# 找出所有水仙花数

for num in range(100, 1000):
    low = num % 10
    mid = num // 10 % 10
    high = num // 100
    if num == low ** 3 + mid ** 3 + high ** 3:
        print(num)
```

上面利用 `//` 和 `%` 拆分一个数的小技巧在写代码的时候还是很常用的。我们要将一个不知道有多少位的正整数进行反转，例如将 `12345` 变成 `54321`，也可以利用这两个运算来实现，代码如下所示。

```Python
# 正整数的反转

num = int(input('num = '))
reversed_num = 0
while num > 0:
    reversed_num = reversed_num * 10 + num % 10
    num //= 10
print(reversed_num)
```

### 百钱百鸡问题

> **说明**：百钱百鸡是我国古代数学家 [张丘建](https://baike.baidu.com/item/%E5%BC%A0%E4%B8%98%E5%BB%BA/10246238) 在《算经》一书中提出的数学问题：鸡翁一值钱五，鸡母一值钱三，鸡雏三值钱一。百钱买百鸡，问鸡翁、鸡母、鸡雏各几何？翻译成现代文是：公鸡 5 元一只，母鸡 3 元一只，小鸡 1 元三只，用 100 块钱买一百只鸡，问公鸡、母鸡、小鸡各有多少只？

```Python
# 《百钱百鸡》问题

# 假设公鸡的数量为x，x的取值范围是0到20
for x in range(0, 21):
    # 假设母鸡的数量为y，y的取值范围是0到33
    for y in range(0, 34):
        z = 100 - x - y
        if 5 * x + 3 * y + z // 3 == 100 and z % 3 == 0:
            print(f'公鸡: {x}只, 母鸡: {y}只, 小鸡: {z}只')
```

上面使用的方法叫做 **穷举法**，也称为 **暴力搜索法**，这种方法通过一项一项的列举备选解决方案中所有可能的候选项并检查每个候选项是否符合问题的描述，最终得到问题的解。这种方法看起来比较笨拙，但对于运算能力非常强大的计算机来说，通常都是一个可行的甚至是不错的选择，只要问题的解存在就能够找到它。

### CRAPS 赌博游戏

> **说明**：CRAPS 又称花旗骰，是美国拉斯维加斯非常受欢迎的一种的桌上赌博游戏。该游戏使用两粒骰子，玩家通过摇两粒骰子获得点数进行游戏。简化后的规则是：玩家第一次摇骰子如果摇出了 7 点或 11 点，玩家胜；玩家第一次如果摇出 2 点、3 点或 12 点，庄家胜；玩家如果摇出其他点数则玩家继续摇骰子，如果玩家摇出了 7 点，庄家胜；如果玩家摇出了第一次摇的点数，玩家胜；其他点数玩家继续摇骰子，直到分出胜负。

```Python
# Craps赌博游戏
# 设定游戏开始时玩家有1000元的赌注
# 游戏结束的条件是玩家破产（输光所有的赌注）

from random import randint

money = 1000
while money > 0:
    print(f'你的总资产为: {money}元')
    go_on = False
    # 下注金额必须大于0小于等于玩家总资产
    while True:
        debt = int(input('请下注: '))
        if 0 < debt <= money:
            break
    # 第一次摇色子
    # 用1到6均匀分布的随机数模拟摇色子得到的点数
    first = randint(1, 6) + randint(1, 6)
    print(f'\n玩家摇出了{first}点')
    if first == 7 or first == 11:
        print('玩家胜!\n')
        money += debt
    elif first == 2 or first == 3 or first == 12:
        print('庄家胜!\n')
        money -= debt
    else:
        go_on = True
    # 第一次摇色子没有分出胜负游戏继续
    while go_on:
        go_on = False
        current = randint(1, 6) + randint(1, 6)
        print(f'玩家摇出了{current}点')
        if current == 7:
            print('庄家胜!\n')
            money -= debt
        elif current == first:
            print('玩家胜!\n')
            money += debt
        else:
            go_on = True
print('你破产了, 游戏结束!')
```

### 斐波那契数列

> **说明**：斐波那契数列（Fibonacci sequence），通常也被称作黄金分割数列，是意大利数学家莱昂纳多·斐波那契（Leonardoda Fibonacci）在《计算之书》中研究在理想假设条件下兔子成长率问题而引入的数列，因此这个数列也常被戏称为“兔子数列”。斐波那契数列的特点是数列的前两个数都是 1，从第三个数开始，每个数都是它前面两个数的和，按照这个规律，斐波那契数列的前 10 个数是：`1, 1, 2, 3, 5, 8, 13, 21, 34, 55`。斐波那契数列在现代物理、准晶体结构、化学等领域都有直接的应用。

```Python
# 输出斐波那契数列前20个数

a, b = 0, 1
for _ in range(20):
    a, b = b, a + b
    print(a)
```

### 打印 100 以内的素数

> **说明**：素数指的是只能被 1 和自身整除的正整数（不包括 1）。

```Python
# 输出100以内的素数

for num in range(2, 100):
    # 假设num是素数
    is_prime = True
    # 在2到num-1之间找num的因子
    for factor in range(2, num):
        # 如果找到了num的因子，num就不是素数
        if num % factor == 0:
            is_prime = False
            break
    # 如果布尔值为True在num是素数
    if is_prime:
        print(num)
```

简单的总结：还是那句话：**分支结构和循环结构非常重要**，是构造程序逻辑的基础，**一定要通过大量的练习来达到融会贯通**。刚才讲到的 CRAPS 赌博游戏那个例子可以作为一个标准，如果你能很顺利的完成这段代码，那么分支和循环结构的知识你就已经掌握了。

